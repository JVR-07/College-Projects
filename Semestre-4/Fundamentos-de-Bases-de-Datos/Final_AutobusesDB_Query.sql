-- CREATE DATABASE
USE master
GO

CREATE DATABASE AUTOBUSESDB
GO

USE AUTOBUSESDB
GO
-- CREATE TABLES
CREATE TABLE CENTRAL 
    (
     CRAL_CODE INTEGER NOT NULL , 
     CRAL_NUMINTERIOR SMALLINT NOT NULL , 
     CRAL_CALLE VARCHAR (100) NOT NULL , 
     CRAL_COLONIA VARCHAR (100) , 
     CRAL_CP INTEGER NOT NULL , 
     CRAL_NUMTEL BIGINT , 
     CRAL_CANTUNI SMALLINT NOT NULL 
	 CONSTRAINT PK_CENTRAL PRIMARY KEY (CRAL_CODE)
    )
GO

CREATE TABLE RUTA 
    (
     RUT_CODE INTEGER NOT NULL , 
     RUT_DISTANCIA FLOAT (3) NOT NULL , 
     RUT_CANTUNI SMALLINT NOT NULL 
	 CONSTRAINT PK_RUTA PRIMARY KEY (RUT_CODE)
    )
GO

CREATE TABLE TURNO 
    (
     TUR_CODE INTEGER NOT NULL , 
     TUR_HORAENTRADA TIME NOT NULL , 
     TUR_HORASALIDA TIME NOT NULL 
	 CONSTRAINT PK_TURNO PRIMARY KEY (TUR_CODE)
    )
GO

CREATE TABLE CONDUCTOR 
    (
     CTOR_CODE INTEGER NOT NULL , 
     CTOR_RFC CHAR (13) NOT NULL , 
     CTOR_NUMLICENCIA CHAR (14) NOT NULL , 
     CTRO_TIPOLICENCIA CHAR (1) NOT NULL , 
     CTOR_PRIMNOMBRE VARCHAR (30) NOT NULL ,
	 CTOR_SEGNOMBRE VARCHAR (30) ,
     CTOR_APELLIDOPAT VARCHAR (35) NOT NULL , 
     CTOR_APELLIDOMAT VARCHAR (35) , 
     CTOR_FECHNAC DATE , 
     TUR_CODE INTEGER NOT NULL ,
	 CONSTRAINT PK_CTOR_CODE PRIMARY KEY (CTOR_CODE),
	 CONSTRAINT FK_TUR_CODE FOREIGN KEY (TUR_CODE) REFERENCES TURNO (TUR_CODE)
    )
GO

CREATE TABLE MARCA 
    (
     MARCA_CODE INTEGER NOT NULL , 
     MARCA_NOMBRE VARCHAR (100) NOT NULL,
	 CONSTRAINT PK_MARCA PRIMARY KEY (MARCA_CODE)
    )
GO

CREATE TABLE COMBUSTIBLE 
    (
     COMB_CODE INTEGER NOT NULL , 
     COMB_NOMBRE VARCHAR (25) NOT NULL,
	 CONSTRAINT PK_COMBUSTIBLE PRIMARY KEY (COMB_CODE)
    )
GO

CREATE TABLE MODELO 
    (
     MOD_CODE INTEGER NOT NULL , 
     MOD_VERSION VARCHAR (30) NOT NULL , 
     MOD_YEAR DATE NOT NULL , 
     MOD_CILINDROS CHAR (2) NOT NULL , 
     COMB_CODE INTEGER NOT NULL , 
     MARCA_CODE INTEGER NOT NULL, 
	 CONSTRAINT PK_MODELO PRIMARY KEY (MOD_CODE),
	 CONSTRAINT FK_COMB_CODE FOREIGN KEY (COMB_CODE) REFERENCES COMBUSTIBLE(COMB_CODE),
	 CONSTRAINT FK_MARCA_CODE FOREIGN KEY (MARCA_CODE) REFERENCES MARCA (MARCA_CODE)
	
    )
GO

CREATE TABLE AUTOBUS 
    (
     BUS_CODE INTEGER, 
     BUS_CANTASIENTOS SMALLINT NOT NULL , 
     BUS_GPSLATITUD FLOAT (4) NOT NULL , 
     BUS_GPSLONGITUD FLOAT (4) NOT NULL , 
     BUS_ESTATUS VARCHAR (13) NOT NULL , 
     CRAL_CODE INTEGER NOT NULL , 
     RUT_CODE INTEGER NOT NULL , 
     CTOR_CODE INTEGER NOT NULL , 
     MOD_CODE INTEGER NOT NULL,
	 CONSTRAINT PK_AUTOBUS PRIMARY KEY (BUS_CODE),
	 CONSTRAINT FK_CRAL_CODE FOREIGN KEY (CRAL_CODE) REFERENCES CENTRAL (CRAL_CODE),
	 CONSTRAINT FK_RUT_CODE_AUTOBUS FOREIGN KEY (RUT_CODE) REFERENCES RUTA (RUT_CODE),
	 CONSTRAINT FK_CTOR_CODE FOREIGN KEY (CTOR_CODE) REFERENCES CONDUCTOR (CTOR_CODE),
	 CONSTRAINT FK_MOD_CODE FOREIGN KEY (MOD_CODE) REFERENCES MODELO (MOD_CODE)
    )
GO

CREATE TABLE PARADA 
    (
     PDA_CODE INTEGER NOT NULL , 
     PDA_CANTPERS SMALLINT NOT NULL , 
     PDA_GPSLATITUD FLOAT NOT NULL , 
     PDA_GPSLONGITUD FLOAT NOT NULL , 
     RUT_CODE INTEGER,
	 CONSTRAINT PK_PARADA PRIMARY KEY (PDA_CODE),
	 CONSTRAINT FK_RUT_CODE_PARADA FOREIGN KEY (RUT_CODE) REFERENCES RUTA (RUT_CODE)
    )
GO

CREATE TABLE USUARIO 
    (
     URIO_CODE INTEGER NOT NULL , 
     URIO_PRIMNOMBRE VARCHAR (25) NOT NULL ,
	 URIO_SEGNOMBRE VARCHAR (25) ,
     URIO_APELLIDOPAT VARCHAR (30) NOT NULL , 
     URIO_APELLIDOMAT VARCHAR (30) , 
     URIO_EMAIL VARCHAR (100) NOT NULL , 
     URIO_NUMTEL BIGINT , 
     URIO_ACOMPA SMALLINT , 
     URIO_GPSLATITUD FLOAT NOT NULL , 
     URIO_GPSLONGITUD FLOAT NOT NULL , 
     BUS_CODE INTEGER , 
     PDA_CODE INTEGER,
	 CONSTRAINT URIO_CODE PRIMARY KEY (URIO_CODE),
	 CONSTRAINT FK_BUS_CODE FOREIGN KEY (BUS_CODE) REFERENCES AUTOBUS (BUS_CODE),
	 CONSTRAINT FK_PDA_CODE FOREIGN KEY (PDA_CODE) REFERENCES PARADA (PDA_CODE)
    )
GO

-- COMBUSTIBLE TABLE
INSERT INTO COMBUSTIBLE VALUES (1,'Diesel')
INSERT INTO COMBUSTIBLE VALUES (2,'Gasolina')

DELETE FROM COMBUSTIBLE WHERE COMB_CODE=2

INSERT INTO COMBUSTIBLE VALUES (2,'Gasolina')
INSERT INTO COMBUSTIBLE VALUES (3,'Gas lp')

UPDATE COMBUSTIBLE SET COMB_NOMBRE='Gas LP' WHERE COMB_CODE=3

INSERT INTO COMBUSTIBLE VALUES (4,'Electricidad')
INSERT INTO COMBUSTIBLE VALUES (5, 'Hidrógeno')

DELETE FROM COMBUSTIBLE WHERE COMB_CODE = 5
SELECT * FROM COMBUSTIBLE

-- MARCA TABLE
INSERT INTO MARCA VALUES (1,'Mercedez')

UPDATE MARCA SET MARCA_NOMBRE='Mercedes' WHERE MARCA_CODE=1

INSERT INTO MARCA VALUES (2,'Volkswagen')
INSERT INTO MARCA VALUES (3,'Dina')
INSERT INTO MARCA VALUES (4,'International')
INSERT INTO MARCA VALUES (5, 'Hyundai')

DELETE FROM MARCA WHERE MARCA_CODE=5

SELECT * FROM MARCA

-- MODELO TABLE
INSERT INTO MODELO VALUES (1,'Urviabus','2008',4,1,1)
INSERT INTO MODELO VALUES (2,'Safiro','2016',4,1,2)

UPDATE MODELO SET MOD_VERSION = 'Zafiro', MOD_YEAR = '2018'

INSERT INTO MODELO VALUES (3,'Runner','2018',6,1,3)
INSERT INTO MODELO VALUES (4,'Boxer','2018',4,1,1)
INSERT INTO MODELO VALUES (5,'4700 SC','2015',6,1,2)

DELETE FROM MODELO WHERE MOD_CODE = 5

SELECT * FROM MODELO

UPDATE MODELO SET MOD_VERSION = 'Super Aero City', MOD_YEAR = '2022', MOD_CILINDROS = 6, COMB_CODE = 3, MARCA_CODE = 4
WHERE MOD_CODE = 4

SELECT * FROM MODELO

-- CENTRAL TABLE
INSERT INTO CENTRAL VALUES (1456,978,'F. Montes de Oca','Hidalgo',22987,6616784567,40)
INSERT INTO CENTRAL VALUES (1478,1024,'20 de Noviembre','Castillo',22056,6641235770,30)
INSERT INTO CENTRAL VALUES (1427,1010,'Paseo del VillaReal','Sanchez Taboda',22746,6649224563,15)

UPDATE CENTRAL SET CRAL_CALLE = 'Paseo del Villareal', CRAL_COLONIA = 'Sanchez Taboada' WHERE CRAL_CODE = 1427

INSERT INTO CENTRAL VALUES (1424,1030,'5 de abril','Obrera',22764,6646789609,15)
INSERT INTO CENTRAL VALUES (1498,4943,'Tijuana - Tecate','El Refugio',22256,6638349139,56)

DELETE FROM CENTRAL WHERE CRAL_CODE = 1498

SELECT * FROM CENTRAL

-- RUTA TABLE
INSERT INTO RUTA VALUES (10032,8,10)
INSERT INTO RUTA VALUES (90027,14,13)
INSERT INTO RUTA VALUES (10090,10,16)

UPDATE RUTA SET RUT_CANTUNI = 25 WHERE RUT_CODE = 10090

INSERT INTO RUTA VALUES (20034,12,18)
INSERT INTO RUTA VALUES (13515,35,25)

DELETE FROM RUTA WHERE RUT_CODE = 13515

SELECT * FROM RUTA

-- PARADA TABLE
INSERT INTO PARADA VALUES (1548,12,35.6895,139.6917,10032)
INSERT INTO PARADA VALUES (398,6,139.6917,-58.3816,90027)
INSERT INTO PARADA VALUES (321,2,55.7558,37.6176,10090)
INSERT INTO PARADA VALUES (8944,1,40.4168,-3.7038,20034)

UPDATE PARADA SET PDA_CANTPERS = 15 WHERE PDA_CODE = 8944

INSERT INTO PARADA VALUES (3258,26,12.8923,-5.2341,10090)

DELETE FROM PARADA WHERE PDA_CODE = 3258

SELECT * FROM PARADA

-- TURNO TABLE
INSERT INTO TURNO VALUES (1,'8:00:00','18:00:00')

UPDATE TURNO SET TUR_HORAENTRADA = '7:00:00', TUR_HORASALIDA = '19:00:00' WHERE TUR_CODE = 1

INSERT INTO TURNO VALUES (2,'19:00:00','7:00:00')
INSERT INTO TURNO VALUES (3,'5:00:00','13:00:00')
INSERT INTO TURNO VALUES (4,'13:00:00','21:00:00')
INSERT INTO TURNO VALUES (5,'21:00:00','5:00:00')

DELETE FROM TURNO WHERE TUR_CODE = 5

SELECT * FROM TURNO

--CONDUCTOR TABLE
INSERT INTO CONDUCTOR VALUES (1223902,'MOCM800512J89','BC202205320136','B','Miguel','Angel','Mora','Cruz','1983-04-22',1)
INSERT INTO CONDUCTOR VALUES (4332093,'SALJ780923K00','BC202208511822','D','Jose','Manuel','Sanchez','Lopez','1990-07-13',2)
INSERT INTO CONDUCTOR VALUES (4436205,'MOPE6903187F7','BC200409118374','D','esmeralda','','morales','perez','2000-01-31',3)

UPDATE CONDUCTOR SET CTOR_PRIMNOMBRE = 'Esmeralda', CTOR_APELLIDOPAT = 'Morales', CTOR_APELLIDOMAT = 'Perez' 
WHERE CTOR_CODE = 4436205

INSERT INTO CONDUCTOR VALUES (8395700,'GOZS8401070L0','BC201002293475','B','Sonia','Fernanda','Gonzalez','Zamora','1979-02-14',4)
INSERT INTO CONDUCTOR VALUES (2398242,'CACJ761201T0H','BC203432234535','B','Jesus','','Camacho','Chavez','2004-03-10',2)

DELETE FROM CONDUCTOR WHERE CTOR_CODE = 2398242

SELECT * FROM CONDUCTOR

--AUTOBUS TABLE
INSERT INTO AUTOBUS VALUES (1223,43,40.7128,74.0060,'Mantenimiento',1456,10032,1223902,1)
INSERT INTO AUTOBUS VALUES (9394,41,-22.9068,-43.1729,'Activo',1478,90027,4332093,2)
INSERT INTO AUTOBUS VALUES (4300,29,51.5074,-0.1278,'Activo',1427,10090,4436205,3)
INSERT INTO AUTOBUS VALUES (8374,37,-33.8688,151.2093,'Mantenimiento',1424,20034,8395700,4)

UPDATE AUTOBUS SET BUS_ESTATUS = 'Activo' WHERE BUS_CODE = 8374

INSERT INTO AUTOBUS VALUES (664,49,116.3562,33.0349,'Activo',1456,90027,4436205,4)

DELETE FROM AUTOBUS WHERE BUS_CODE = 664

SELECT * FROM AUTOBUS

--USUARIO TABLE
INSERT INTO USUARIO VALUES (838742,'Marta','Maria','Escalante','Garcia','martag@gmail.com',6643458690,2,35.6895,139.6917,1223,1548)
INSERT INTO USUARIO VALUES (538724,'Juan','','Hernandez','Gomez','hernanj12@gmail.com',6617866453,4,139.6917,-58.3816,9394,398)
INSERT INTO USUARIO VALUES (842902,'Cecilia','Jacqueline','Lopez','Arrollo','ceci1990@gmail.com',6637225413,1,55.7558,37.6176,4300,321)
INSERT INTO USUARIO VALUES (989836,'Ana','','Martinez','Torres','torresana3928@gmail.com',6648902738,3,40.4168,-3.7038,8374,8944)

UPDATE USUARIO SET URIO_SEGNOMBRE = 'Laura' WHERE URIO_CODE = 989836 

INSERT INTO USUARIO VALUES (859134,'Jael','Jireh','Flores','Robles','jjfr1652@gmail.com',6634728421,0,12.4590,14.3251,1223,1548)

DELETE FROM USUARIO WHERE URIO_CODE = 859134

SELECT * FROM USUARIO